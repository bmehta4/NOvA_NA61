\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data}{\section{Neutrino\-Flux\-Reweight\-:\-:Interaction\-Chain\-Data Class Reference}
\label{class_neutrino_flux_reweight_1_1_interaction_chain_data}\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
}


Information about the chain of interactions leading to a neutrino.  




{\ttfamily \#include $<$Interaction\-Chain\-Data.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_aa936bc29461049e00fe62ccf528db2eb}{Interaction\-Chain\-Data} ()
\begin{DoxyCompactList}\small\item\em boring old default constructor \end{DoxyCompactList}\item 
\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_af2ab1388c8d0c81c53b31f9c3e22fb4e}{Interaction\-Chain\-Data} (\hyperlink{classnu__g4numi}{nu\-\_\-g4numi} $\ast$nu, const char $\ast$tgtcfg, const char $\ast$horncfg)
\item 
\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_ae8ee384bee786269c30073a2a9600d31}{Interaction\-Chain\-Data} (bsim\-::\-Dk2\-Nu $\ast$nu, bsim\-::\-Dk\-Meta $\ast$meta)
\begin{DoxyCompactList}\small\item\em create an interaction chain from the new dk2nu format \end{DoxyCompactList}\item 
std\-::ostream \& \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a27b0c5dc28fcec9536ed6dddf79d0501}{print} (std\-::ostream \&os=std\-::cout) const 
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
std\-::vector$<$ \hyperlink{class_neutrino_flux_reweight_1_1_interaction_data}{Interaction\-Data} $>$ \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}{interaction\-\_\-chain}
\begin{DoxyCompactList}\small\item\em vector of neutrino ancestors \end{DoxyCompactList}\item 
\hyperlink{class_neutrino_flux_reweight_1_1_target_data}{Target\-Data} \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}{tar\-\_\-info}
\begin{DoxyCompactList}\small\item\em Information about the hadron which exited the target. \end{DoxyCompactList}\item 
std\-::vector\\*
$<$ \hyperlink{class_neutrino_flux_reweight_1_1_particles_through_volumes_data}{Particles\-Through\-Volumes\-Data} $>$ \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\-\_\-info}
\begin{DoxyCompactList}\small\item\em Information about all particles that pass through volumes without interacting. \end{DoxyCompactList}\item 
std\-::string \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}{target\-\_\-config}
\begin{DoxyCompactList}\small\item\em The target configuration. Example\-: le010z. \end{DoxyCompactList}\item 
std\-::string \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a343d6a28ec2d41252a6067833b75f831}{horn\-\_\-config}
\begin{DoxyCompactList}\small\item\em The horn configuration. Example\-: 185i. \end{DoxyCompactList}\item 
int \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_aca185ce4c11a46ea16b29a55ff97a490}{playlist}
\begin{DoxyCompactList}\small\item\em The tgt playlist (exact position of the target after survey) \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}{is\-\_\-fast\-\_\-decay} (int pdg)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Information about the chain of interactions leading to a neutrino. 

Definition at line 19 of file Interaction\-Chain\-Data.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_aa936bc29461049e00fe62ccf528db2eb}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!Interaction\-Chain\-Data@{Interaction\-Chain\-Data}}
\index{Interaction\-Chain\-Data@{Interaction\-Chain\-Data}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{Interaction\-Chain\-Data}]{\setlength{\rightskip}{0pt plus 5cm}Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::\-Interaction\-Chain\-Data (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_aa936bc29461049e00fe62ccf528db2eb}


boring old default constructor 



Definition at line 6 of file Interaction\-Chain\-Data.\-cpp.


\begin{DoxyCode}
6 \{\}
\end{DoxyCode}
\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_af2ab1388c8d0c81c53b31f9c3e22fb4e}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!Interaction\-Chain\-Data@{Interaction\-Chain\-Data}}
\index{Interaction\-Chain\-Data@{Interaction\-Chain\-Data}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{Interaction\-Chain\-Data}]{\setlength{\rightskip}{0pt plus 5cm}Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::\-Interaction\-Chain\-Data (
\begin{DoxyParamCaption}
\item[{{\bf nu\-\_\-g4numi} $\ast$}]{nu, }
\item[{const char $\ast$}]{tgtcfg, }
\item[{const char $\ast$}]{horncfg}
\end{DoxyParamCaption}
)}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_af2ab1388c8d0c81c53b31f9c3e22fb4e}
create an interaction chain from the old g4numi nudata structure tgtcfg specified the target configuration. Example\-: le010z horncfg specifies the horn configuration. Example\-: 185i 

Definition at line 7 of file Interaction\-Chain\-Data.\-cpp.


\begin{DoxyCode}
9                                                                  \{
10     
11     \textcolor{comment}{// Fill in information about the hadron exiting the target}
12     \textcolor{comment}{// this information is needed in order to reweight yields}
13     \textcolor{comment}{// off the target (i.e., MIPP)}
14     \textcolor{keywordtype}{double} tarP[3];
15     tarP[0] = nu->\hyperlink{classnu__g4numi_a8693b10daf61759ad2decb2c3aac6a9e}{tpx};
16     tarP[1] = nu->\hyperlink{classnu__g4numi_a533f9a7e3002a702856c25dd1e5c7058}{tpy};
17     tarP[2] = nu->\hyperlink{classnu__g4numi_a63eb35fe1697f426543e34652202e30b}{tpz};
18     \textcolor{keywordtype}{double} tarV[3];
19     tarV[0] = nu->\hyperlink{classnu__g4numi_a8675345bdaaec6f0d4ff5f57571133a0}{tvx};
20     tarV[1] = nu->\hyperlink{classnu__g4numi_ac81b906ee11d4c5e74a1b80378cae373}{tvy};
21     tarV[2] = nu->\hyperlink{classnu__g4numi_adef9f7bf0e713b329e9af89ae32183ab}{tvz};
22     
23     \textcolor{keyword}{static} \hyperlink{class_numi2_pdg}{Numi2Pdg} numi2pdg;
24     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}{tar\_info} = TargetData(tarP,numi2pdg.\hyperlink{class_numi2_pdg_ac8d5438ffd52928a82738feed56e4f90}{GetPdg}(nu->\hyperlink{classnu__g4numi_a1047ac371479cee32c28f56adf885515}{tptype}),tarV,-1);
25     
26     \textcolor{comment}{// loop over trajectories, create InteractionData objects,}
27     \textcolor{comment}{// and add them to the interaction\_chain vector    }
28     \textcolor{comment}{//(Note about units: In nudata format, the momentum unit is MeV)}
29     
30     Int\_t ntraj = nu->\hyperlink{classnu__g4numi_abdbe76af4b20f3b5b5b2fb4b92156b42}{ntrajectory};
31     \textcolor{keywordflow}{if}(ntraj>10)ntraj = 10;
32     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} itraj=0;itraj<(ntraj-1);itraj++)\{
33       \textcolor{keywordtype}{double} incP[3];
34       incP[0] = nu->\hyperlink{classnu__g4numi_a11ce125811f5f35337733e18f3753d31}{pprodpx}[itraj+1]/1000.;
35       incP[1] = nu->\hyperlink{classnu__g4numi_a7fa5412e9c5006b884f09226ae2c350a}{pprodpy}[itraj+1]/1000.;
36       incP[2] = nu->\hyperlink{classnu__g4numi_a0bd7772ccdfe00660ce45d94c107a240}{pprodpz}[itraj+1]/1000.;
37       
38       Int\_t itraj\_prod = itraj + 1;
39       Int\_t pdg\_prod   = nu->\hyperlink{classnu__g4numi_a4ed6688aee6debd26637a0401e5ef475}{pdg}[itraj\_prod];
40       std::string this\_proc = std::string(nu->\hyperlink{classnu__g4numi_a6583de2ce34a5d19409c09cc0b63692f}{proc}[itraj\_prod]);
41       \textcolor{comment}{// skip over etas and other swiftly decaying particles}
42       \textcolor{comment}{// we are interested in their daughters}
43  
44       \textcolor{comment}{//It seems that the next while is causing seg fault in gcc 6.3:}
45       \textcolor{comment}{/*  while( is\_fast\_decay(pdg\_prod) )\{}
46 \textcolor{comment}{          itraj\_prod++;}
47 \textcolor{comment}{          pdg\_prod = nu->pdg[itraj\_prod];}
48 \textcolor{comment}{          \} */}   
49       \textcolor{keywordflow}{if}( \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}{is\_fast\_decay}(pdg\_prod) )\{
50         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ifast = itraj\_prod + 1; ifast < (ntraj-1); ifast++ )\{
51           pdg\_prod = nu->\hyperlink{classnu__g4numi_a4ed6688aee6debd26637a0401e5ef475}{pdg}[ifast];
52           itraj\_prod++;
53           pdg\_prod = nu->\hyperlink{classnu__g4numi_a4ed6688aee6debd26637a0401e5ef475}{pdg}[itraj\_prod];
54           \textcolor{keywordflow}{if}( !\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}{is\_fast\_decay}(pdg\_prod) ) \textcolor{keywordflow}{break};      
55         \}
56       \}        
57       \textcolor{keywordtype}{double} prodP[3];
58       prodP[0] = nu->\hyperlink{classnu__g4numi_a309ea4b88683c5978593c0d474b1a976}{startpx}[itraj\_prod]/1000.;
59       prodP[1] = nu->\hyperlink{classnu__g4numi_a5247e8e73a100a7064f032806f542d38}{startpy}[itraj\_prod]/1000.;
60       prodP[2] = nu->\hyperlink{classnu__g4numi_a6bec79e4a2effa3cdaa28a1f02ae8124}{startpz}[itraj\_prod]/1000.;
61       
62       \textcolor{keywordtype}{double} vtx[3];
63       vtx[0]=nu->\hyperlink{classnu__g4numi_ab9ea407b9c38c0c73b606d9f6f4df80a}{startx}[itraj\_prod];
64       vtx[1]=nu->\hyperlink{classnu__g4numi_a58d39dbb466f353155aca6a6e7a2cc12}{starty}[itraj\_prod];
65       vtx[2]=nu->\hyperlink{classnu__g4numi_afc1991c5be450f31577f4e1d31dceb2f}{startz}[itraj\_prod];
66 
67       InteractionData inter(itraj, incP,nu->\hyperlink{classnu__g4numi_a4ed6688aee6debd26637a0401e5ef475}{pdg}[itraj],prodP,pdg\_prod,std::string(nu->
      \hyperlink{classnu__g4numi_a72d170869c1eb191d10366d07024417c}{fvol}[itraj]),this\_proc,vtx);   
68       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}{interaction\_chain}.push\_back(inter);
69     \}
70     
71     \textcolor{comment}{//}
72     \textcolor{comment}{//nothing to fill for ParticlesThroughVolumesData here. If we are using nudata format}
73     \textcolor{comment}{//the size of the vector of ParticlesThroughVolumesData objects will be zero.}
74     \textcolor{comment}{//    }
75 
76     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}{target\_config}=tgtcfg;
77     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a343d6a28ec2d41252a6067833b75f831}{horn\_config}=horncfg;
78     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_aca185ce4c11a46ea16b29a55ff97a490}{playlist} = -1;
79   \}
\end{DoxyCode}
\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_ae8ee384bee786269c30073a2a9600d31}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!Interaction\-Chain\-Data@{Interaction\-Chain\-Data}}
\index{Interaction\-Chain\-Data@{Interaction\-Chain\-Data}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{Interaction\-Chain\-Data}]{\setlength{\rightskip}{0pt plus 5cm}Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::\-Interaction\-Chain\-Data (
\begin{DoxyParamCaption}
\item[{bsim\-::\-Dk2\-Nu $\ast$}]{nu, }
\item[{bsim\-::\-Dk\-Meta $\ast$}]{meta}
\end{DoxyParamCaption}
)}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_ae8ee384bee786269c30073a2a9600d31}


create an interaction chain from the new dk2nu format 



Definition at line 81 of file Interaction\-Chain\-Data.\-cpp.


\begin{DoxyCode}
82                                                               \{
83     
84     \textcolor{comment}{// Fill in information about the hadron exiting the target}
85     \textcolor{comment}{// this information is needed in order to reweight yields}
86     \textcolor{comment}{// off the target (i.e., MIPP)}
87     std::string mode(getenv(\textcolor{stringliteral}{"MODE"}));
88     \textcolor{comment}{//if(mode=="OPT")std::cout<<"MODE IS OPT interactionchaindata "<<std::endl;}
89     \textcolor{comment}{//else std::cout<<"MODE not recognized. InteractionChainData "<<std::endl;}
90     
91    \textcolor{comment}{// std::cout<<" The environment is "<<getenv("MODE")<<std::endl;}
92     \textcolor{keywordtype}{double} tarP[3];
93     tarP[0]=nu->tgtexit.tpx;
94     tarP[1]=nu->tgtexit.tpy;
95     tarP[2]=nu->tgtexit.tpz;
96     \textcolor{keywordtype}{double} tarV[3];
97     tarV[0]=nu->tgtexit.tvx;
98     tarV[1]=nu->tgtexit.tvy;
99     tarV[2]=nu->tgtexit.tvz;
100     \textcolor{keywordtype}{int} Nskip = 0;
101     \textcolor{comment}{//we will fill tardata after looking into the ancestry for the right index.}
102     
103     \textcolor{comment}{// loop over trajectories, create InteractionData objects,}
104     \textcolor{comment}{// and add them to the interaction\_chain vector}
105     \textcolor{comment}{// Note about units: In dk2nu format, the momentum unit is GeV}
106 
107     Int\_t ntraj = nu->ancestor.size();
108     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} itraj=0;itraj<(ntraj-1);itraj++)\{
109       
110       \textcolor{keywordtype}{int} pdg\_inc=nu->ancestor[itraj].pdg;
111       \textcolor{keywordtype}{double} incP[3];
112       incP[0]=0.0;incP[1]=0.0;incP[2]=0.0;
113       \textcolor{comment}{// itraj is the index of the projectile in each interaction.}
114       \textcolor{comment}{// one can find out what it did by looking at}
115       \textcolor{comment}{//       ancestor[itraj+1].proc}
116       \textcolor{comment}{// since 'proc' records the process which made the particle.}
117       \textcolor{comment}{//}
118       \textcolor{comment}{// Unfortunately, the pprod variables in g4numi v5 are needlessly complicated}
119       \textcolor{comment}{//}
120       \textcolor{comment}{// (1) If the particle at itraj *interacts* then pprod seems to hold}
121       \textcolor{comment}{// the momentum of the particle just before the interaction}
122       \textcolor{comment}{// }
123       \textcolor{comment}{// (2) If the particle at itraj *decays* then pprod seems to hold the}
124       \textcolor{comment}{// momentum of the particle at itraj-1, just before it interacts}
125       \textcolor{comment}{//}
126       \textcolor{comment}{// (3) If the particle at itraj is the *result of a decay*, then pprod holds}
127       \textcolor{comment}{// something that looks like the momentum of the parent.}
128       \textcolor{comment}{//}
129       \textcolor{comment}{// Generally for hadron production studies, the second case isn't interesting}
130     \textcolor{comment}{//  if(nu->ancestor[itraj].pprodpz==0)std::cout<<"Found incident proton with 0 GeV Energy"<<std::endl;}
131       \textcolor{keywordflow}{if}( nu->ancestor[itraj].pprodpz != 0)\{
132         incP[0] = nu->ancestor[itraj].pprodpx;
133         incP[1] = nu->ancestor[itraj].pprodpy;
134         incP[2] = nu->ancestor[itraj].pprodpz;
135       
136       \}
137       \textcolor{keywordflow}{else}\{
138         incP[0]=nu->ancestor[itraj].stoppx;
139         incP[1]=nu->ancestor[itraj].stoppy;
140         incP[2]=nu->ancestor[itraj].stoppz;
141       \}
142       Int\_t itraj\_prod = itraj + 1;
143       Int\_t pdg\_prod   = nu->ancestor[itraj\_prod].pdg;
144       std::string this\_proc = std::string(nu->ancestor[itraj\_prod].proc);
145       
146       \textcolor{comment}{// skip over etas and other swiftly decaying particles}
147       \textcolor{comment}{// we are interested in their daughters}
148       \textcolor{comment}{//It seems that the next while is causing seg fault in gcc 6.3:}
149       \textcolor{comment}{/*while( is\_fast\_decay(pdg\_prod) )\{}
150 \textcolor{comment}{        itraj\_prod++;}
151 \textcolor{comment}{        Nskip++;}
152 \textcolor{comment}{        pdg\_prod = nu->ancestor[itraj\_prod].pdg;}
153 \textcolor{comment}{        \}*/}
154       \textcolor{keywordflow}{if}( \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}{is\_fast\_decay}(pdg\_prod) )\{
155         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ifast = itraj\_prod + 1; ifast < (ntraj-1); ifast++ )\{
156           itraj\_prod++;
157           Nskip++;
158           pdg\_prod = nu->ancestor[itraj\_prod].pdg;
159           \textcolor{keywordflow}{if}( !\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}{is\_fast\_decay}(pdg\_prod) ) \textcolor{keywordflow}{break};      
160         \}
161       \}
162       \textcolor{keywordtype}{double} prodP[3];
163       prodP[0] = nu->ancestor[itraj\_prod].startpx;
164       prodP[1] = nu->ancestor[itraj\_prod].startpy;
165       prodP[2] = nu->ancestor[itraj\_prod].startpz;
166       
167       \textcolor{keywordtype}{double} vtx[3];
168       vtx[0]=nu->ancestor[itraj\_prod].startx;
169       vtx[1]=nu->ancestor[itraj\_prod].starty;
170       vtx[2]=nu->ancestor[itraj\_prod].startz;
171       std::string this\_vol=nu->ancestor[itraj\_prod].ivol;
172       
173       \textcolor{comment}{//Get Rid of Hydrogen}
174         \textcolor{keywordflow}{if}(pdg\_prod == 1000010020 || pdg\_inc == 1000010020|| pdg\_inc == 1000020030||pdg\_prod==1000020030)\{
175       \textcolor{comment}{// std::cout<<"InteractionChainData::Unusual pdgcode found "<<pdg\_prod<<std::endl; //For now just
       skipping these deuterons}
176         \textcolor{keywordflow}{continue};
177         \}
178       
179       InteractionData inter(itraj, incP,pdg\_inc,prodP,pdg\_prod,
180                             this\_vol,this\_proc,vtx);   
181       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}{interaction\_chain}.push\_back(inter);
182 
183     \}\textcolor{comment}{// end loop over trajectories}
184     \textcolor{comment}{/*&int tptype = numi2pdg.GetPdg(nu->tgtexit.tptype);}
185 \textcolor{comment}{    if(mode=="NUMI")tptype = nu->tgtexit.tptype; this was added by DUNE... seems not right (Leo) */}
186       \textcolor{comment}{//  std::cout<<"The tptype::InteractionChainData "<<tptype<<" "<<nu->tgtexit.tptype<<std::endl;}
187     \textcolor{keywordflow}{if}(meta->vintnames.size()==0)\{
188       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}{tar\_info} = TargetData(tarP,nu->tgtexit.tptype,tarV,-1);
189     \}
190     \textcolor{keywordflow}{else}\{    
191       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}{tar\_info} = TargetData(tarP,nu->tgtexit.tptype,tarV,nu->vint[0]-Nskip);
192     \}
193     
194     \textcolor{comment}{//Filling here the ParticlesThroughVolumesData info:}
195     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\_info}.clear();
196     \textcolor{comment}{//Looking IC, DPIP and DVOL:}
197     \textcolor{keywordtype}{int} pdgs[3];
198     \textcolor{keywordtype}{double} moms[3];
199     \textcolor{keywordtype}{double} amount\_IC[3],amount\_DPIP[3],amount\_DVOL[3];
200     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ii=0;ii<3;ii++)\{
201       pdgs[ii] = 0; moms[ii] = 0; 
202       amount\_IC[ii] = 0; amount\_DPIP[ii] = 0; amount\_DVOL[ii] = 0;
203     \}
204     
205     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ii=0;ii<3;ii++)\{
206       \textcolor{keywordflow}{if}(nu->ancestor.size()==3 && ii==2)\textcolor{keywordflow}{continue};
207       pdgs[ii] = nu->ancestor[nu->ancestor.size()-ii-2].pdg;
208       moms[ii] = sqrt(pow(nu->ancestor[nu->ancestor.size()-ii-2].startpx,2)+
209                         pow(nu->ancestor[nu->ancestor.size()-ii-2].startpy,2)+
210                         pow(nu->ancestor[nu->ancestor.size()-ii-2].startpz,2));
211       
212       \textcolor{comment}{//Amounts:}
213       \textcolor{comment}{//control:}
214       \textcolor{keywordflow}{if}( (nu->vdbl)[ii] <0 || (nu->vdbl)[ii+3] <0 || (nu->vdbl)[ii+6] <0 || (nu->vdbl)[ii+9] <0)\{
215         std::cout<< \textcolor{stringliteral}{"ERROR FILLING AMOUNT OF MATERIAL CROSSED (In InteractionChainData) !!!"} <<std::endl;
216       \}
217       amount\_IC[ii]   = (nu->vdbl)[ii] + (nu->vdbl)[ii+3];
218       amount\_DPIP[ii] = (nu->vdbl)[ii+6];
219       amount\_DVOL[ii] = (nu->vdbl)[ii+9];
220     \}
221     
222     ParticlesThroughVolumesData tmp\_ptv\_IC(pdgs,amount\_IC,moms,\textcolor{stringliteral}{"IC"});
223     ParticlesThroughVolumesData tmp\_ptv\_DPIP(pdgs,amount\_DPIP,moms,\textcolor{stringliteral}{"DPIP"});
224     ParticlesThroughVolumesData tmp\_ptv\_DVOL(pdgs,amount\_DVOL,moms,\textcolor{stringliteral}{"DVOL"});
225     
226     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\_info}.push\_back(tmp\_ptv\_IC);
227     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\_info}.push\_back(tmp\_ptv\_DPIP);
228     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\_info}.push\_back(tmp\_ptv\_DVOL);\textcolor{comment}{}
229 \textcolor{comment}{    ///}
230 \textcolor{comment}{}    
231     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}{target\_config}=meta->tgtcfg;
232     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a343d6a28ec2d41252a6067833b75f831}{horn\_config}=meta->horncfg;
233     \textcolor{keywordflow}{if}((mode==\textcolor{stringliteral}{"REF"})||(mode==\textcolor{stringliteral}{"OPT"}))\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}{target\_config} = \textcolor{stringliteral}{"le00zmi"};
234     \textcolor{comment}{//special tgt configuration for Minerva (exact longitudinal position after survey)}
235     \textcolor{comment}{//check for other experiments}
236     \textcolor{keywordflow}{if}(meta->vintnames.size()>1)\{
237       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_aca185ce4c11a46ea16b29a55ff97a490}{playlist} = nu->vint[1];
238     \}
239     \textcolor{keywordflow}{else}\{
240       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_aca185ce4c11a46ea16b29a55ff97a490}{playlist} = -1;
241     \}
242     
243   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!is\-\_\-fast\-\_\-decay@{is\-\_\-fast\-\_\-decay}}
\index{is\-\_\-fast\-\_\-decay@{is\-\_\-fast\-\_\-decay}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{is\-\_\-fast\-\_\-decay}]{\setlength{\rightskip}{0pt plus 5cm}bool Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::is\-\_\-fast\-\_\-decay (
\begin{DoxyParamCaption}
\item[{int}]{pdg}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_a4297c9ba702c5c205e9624b8bdcc6471}


Definition at line 265 of file Interaction\-Chain\-Data.\-cpp.


\begin{DoxyCode}
265                                                  \{
266     
267     \textcolor{keywordtype}{bool} fast\_decay = \textcolor{keyword}{false};
268     \textcolor{keywordflow}{if}( (pdg==221)||(pdg==331)||(pdg==3212)||(pdg==113)||(pdg==223) )fast\_decay = \textcolor{keyword}{true};
269     \textcolor{keywordflow}{return} fast\_decay;
270   \}
\end{DoxyCode}
\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_a27b0c5dc28fcec9536ed6dddf79d0501}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!print@{print}}
\index{print@{print}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}std\-::ostream \& Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::print (
\begin{DoxyParamCaption}
\item[{std\-::ostream \&}]{os = {\ttfamily std\-:\-:cout}}
\end{DoxyParamCaption}
) const}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_a27b0c5dc28fcec9536ed6dddf79d0501}


Definition at line 245 of file Interaction\-Chain\-Data.\-cpp.


\begin{DoxyCode}
245                                                              \{
246     \textcolor{keyword}{using namespace }std;
247     os<<\textcolor{stringliteral}{"==== InteractionChainData ====\(\backslash\)n"}
248       <<\textcolor{stringliteral}{" *config* "}<<\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}{target\_config}<<\textcolor{stringliteral}{" "}<<\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a343d6a28ec2d41252a6067833b75f831}{horn\_config}
249       <<\textcolor{stringliteral}{"\(\backslash\)n *target info*\(\backslash\)n  "};
250     \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}{tar\_info}.\hyperlink{class_neutrino_flux_reweight_1_1_target_data_a3bd231576e6a92d78a95bef604878e5b}{print}(os);
251     os<<\textcolor{stringliteral}{"\(\backslash\)n *ancestors*\(\backslash\)n"};
252     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}{interaction\_chain}.size(); i++)\{
253       os<<\textcolor{stringliteral}{"   "};
254       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}{interaction\_chain}[i].print(os);
255     \}
256     os<<\textcolor{stringliteral}{"\(\backslash\)n *Particlethrough volumes:*\(\backslash\)n"};
257     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i=0; i<\hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\_info}.size(); i++)\{
258       os<<\textcolor{stringliteral}{"   "};
259       \hyperlink{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{ptv\_info}[i].print(os);
260     \}
261     os<<endl;
262     \textcolor{keywordflow}{return} os;
263   \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_a343d6a28ec2d41252a6067833b75f831}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!horn\-\_\-config@{horn\-\_\-config}}
\index{horn\-\_\-config@{horn\-\_\-config}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{horn\-\_\-config}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::horn\-\_\-config}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_a343d6a28ec2d41252a6067833b75f831}


The horn configuration. Example\-: 185i. 



Definition at line 50 of file Interaction\-Chain\-Data.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!interaction\-\_\-chain@{interaction\-\_\-chain}}
\index{interaction\-\_\-chain@{interaction\-\_\-chain}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{interaction\-\_\-chain}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<${\bf Interaction\-Data}$>$ Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::interaction\-\_\-chain}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_a5864063b9c20b4f70e4f1e355df21963}


vector of neutrino ancestors 



Definition at line 38 of file Interaction\-Chain\-Data.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_aca185ce4c11a46ea16b29a55ff97a490}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!playlist@{playlist}}
\index{playlist@{playlist}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{playlist}]{\setlength{\rightskip}{0pt plus 5cm}int Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::playlist}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_aca185ce4c11a46ea16b29a55ff97a490}


The tgt playlist (exact position of the target after survey) 



Definition at line 53 of file Interaction\-Chain\-Data.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!ptv\-\_\-info@{ptv\-\_\-info}}
\index{ptv\-\_\-info@{ptv\-\_\-info}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{ptv\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<${\bf Particles\-Through\-Volumes\-Data}$>$ Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::ptv\-\_\-info}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_adda6bc8863579964b62e3d4f51e14926}


Information about all particles that pass through volumes without interacting. 



Definition at line 44 of file Interaction\-Chain\-Data.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!tar\-\_\-info@{tar\-\_\-info}}
\index{tar\-\_\-info@{tar\-\_\-info}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{tar\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Target\-Data} Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::tar\-\_\-info}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_a6df89bff97001a4988487fcfb9f4acea}


Information about the hadron which exited the target. 



Definition at line 41 of file Interaction\-Chain\-Data.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}{\index{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}!target\-\_\-config@{target\-\_\-config}}
\index{target\-\_\-config@{target\-\_\-config}!NeutrinoFluxReweight::InteractionChainData@{Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data}}
\subsubsection[{target\-\_\-config}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string Neutrino\-Flux\-Reweight\-::\-Interaction\-Chain\-Data\-::target\-\_\-config}}\label{class_neutrino_flux_reweight_1_1_interaction_chain_data_a8362a0f94df2bd321e0b60a38c41fb7a}


The target configuration. Example\-: le010z. 



Definition at line 47 of file Interaction\-Chain\-Data.\-h.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
include/\hyperlink{_interaction_chain_data_8h}{Interaction\-Chain\-Data.\-h}\item 
src/\hyperlink{_interaction_chain_data_8cpp}{Interaction\-Chain\-Data.\-cpp}\end{DoxyCompactItemize}
