\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter}{\section{Neutrino\-Flux\-Reweight\-:\-:Thin\-Targetp\-C\-Nucleon\-Reweighter Class Reference}
\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter}\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
}


Reweighter of thin target p,n production.  




{\ttfamily \#include $<$Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h$>$}

Inheritance diagram for Neutrino\-Flux\-Reweight\-:\-:Thin\-Targetp\-C\-Nucleon\-Reweighter\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae60f31bc3ac4ad48e5a32c2b64513457}{Thin\-Targetp\-C\-Nucleon\-Reweighter} (int iuniv, const \hyperlink{class_neutrino_flux_reweight_1_1_parameter_table}{Parameter\-Table} \&cv\-\_\-pars, const \hyperlink{class_neutrino_flux_reweight_1_1_parameter_table}{Parameter\-Table} \&univ\-\_\-pars)
\item 
virtual \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3d6a84d222e16608b80eaaa11f9be224}{$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter} ()
\item 
virtual bool \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a974bafd329ce322beef237061f446694}{can\-Reweight} (const \hyperlink{class_neutrino_flux_reweight_1_1_interaction_data}{Interaction\-Data} \&aa)
\begin{DoxyCompactList}\small\item\em can the particular instance of this class reweight this interaction? \end{DoxyCompactList}\item 
virtual double \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a6bf9833d98dab84af820f05cf2ff851b}{calculate\-Weight} (const \hyperlink{class_neutrino_flux_reweight_1_1_interaction_data}{Interaction\-Data} \&aa)
\begin{DoxyCompactList}\small\item\em calculate a weight for this interaction given the central value parameters and the parameters for this universe. The weight is something like\-: f(cv)/f(M\-C) $\ast$ f(univ)/f(cv) where cv in this case corresponds to the best value of the parameter, given the data. If univ\-\_\-pars=cv\-\_\-pars then we are calculating a central value weight \end{DoxyCompactList}\item 
double \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a639fe43b3b14e2f1fd277dbbab71cae1}{calculate\-Data\-Scale} (int inc\-\_\-pdg, double inc\-\_\-mom, int prod\-\_\-pdg, double xf, double pt)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a42193d9c122fad580b96311a7b5e13fb}{data\-\_\-prod\-\_\-xs}
\item 
std\-::vector$<$ float $>$ \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_affc490a2bc6f148c1eab12f3cba2457d}{vbin\-\_\-data\-\_\-p}
\item 
std\-::vector$<$ float $>$ \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3ad5552b4cf05ff2f81a93f3d13432ad}{vbin\-\_\-data\-\_\-n}
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a1c83cab529f6ce4d0f49370289bdf7f9}{i\-Univ}
\item 
const \hyperlink{class_neutrino_flux_reweight_1_1_parameter_table}{Parameter\-Table} \& \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae86a08603fb33286d960ec7c87024f37}{cv\-Pars}
\item 
const \hyperlink{class_neutrino_flux_reweight_1_1_parameter_table}{Parameter\-Table} \& \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univ\-Pars}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Reweighter of thin target p,n production. 

Definition at line 15 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae60f31bc3ac4ad48e5a32c2b64513457}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!Thin\-Targetp\-C\-Nucleon\-Reweighter@{Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\index{Thin\-Targetp\-C\-Nucleon\-Reweighter@{Thin\-Targetp\-C\-Nucleon\-Reweighter}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{Thin\-Targetp\-C\-Nucleon\-Reweighter}]{\setlength{\rightskip}{0pt plus 5cm}Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter (
\begin{DoxyParamCaption}
\item[{int}]{iuniv, }
\item[{const {\bf Parameter\-Table} \&}]{cv\-\_\-pars, }
\item[{const {\bf Parameter\-Table} \&}]{univ\-\_\-pars}
\end{DoxyParamCaption}
)}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae60f31bc3ac4ad48e5a32c2b64513457}


Definition at line 10 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-cpp.


\begin{DoxyCode}
10                                                                                                            
                                  :\hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a1c83cab529f6ce4d0f49370289bdf7f9}{iUniv}(iuniv),\hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae86a08603fb33286d960ec7c87024f37}{cvPars}(cv\_pars),\hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univPars}(univ\_pars)\{
11     
12     ThinTargetBins* Thinbins =  \hyperlink{class_neutrino_flux_reweight_1_1_thin_target_bins_aeff5cf7220dd08322f5abac2cbc7ff33}{ThinTargetBins::getInstance}();
13     
14     \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_affc490a2bc6f148c1eab12f3cba2457d}{vbin\_data\_p}.reserve(Thinbins->GetNbins\_pC\_pX\_NA49());
15     \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3ad5552b4cf05ff2f81a93f3d13432ad}{vbin\_data\_n}.reserve(Thinbins->GetNbins\_pC\_nX\_NA49());
16     \textcolor{comment}{// const boost::interprocess::flat\_map<std::string, double>& cv\_table   = cvPars.getMap();}
17     \textcolor{comment}{// const boost::interprocess::flat\_map<std::string, double>& univ\_table = univPars.getMap();}
18     
19      \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a42193d9c122fad580b96311a7b5e13fb}{data\_prod\_xs} = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(\textcolor{stringliteral}{"prod\_prtC\_xsec"});
20     
21     \textcolor{comment}{//the number of bins needs to be written from the xmls files }
22     \textcolor{keywordtype}{char} namepar[100];
23     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ii=0;ii<Thinbins->GetNbins\_pC\_pX\_NA49();ii++)\{
24       
25       sprintf(namepar,\textcolor{stringliteral}{"ThinTarget\_pC\_%s\_sys\_%d"},\textcolor{stringliteral}{"p"},ii);
26       \textcolor{keywordtype}{double} data\_cv  = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae86a08603fb33286d960ec7c87024f37}{cvPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(std::string(namepar));
27       \textcolor{keywordtype}{double} data\_sys = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(std::string(namepar));
28       sprintf(namepar,\textcolor{stringliteral}{"ThinTarget\_pC\_%s\_stats\_%d"},\textcolor{stringliteral}{"p"},ii);
29       \textcolor{keywordtype}{double} data\_sta = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(std::string(namepar));       
30       \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_affc490a2bc6f148c1eab12f3cba2457d}{vbin\_data\_p}.push\_back(data\_sta + data\_sys - data\_cv);
31       
32     \}    
33 
34     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} ii=0;ii<Thinbins->GetNbins\_pC\_nX\_NA49();ii++)\{
35       
36       sprintf(namepar,\textcolor{stringliteral}{"ThinTarget\_pC\_%s\_sys\_%d"},\textcolor{stringliteral}{"n"},ii);
37       \textcolor{keywordtype}{double} data\_cv  = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae86a08603fb33286d960ec7c87024f37}{cvPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(std::string(namepar));
38       \textcolor{keywordtype}{double} data\_sys = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(std::string(namepar));
39       sprintf(namepar,\textcolor{stringliteral}{"ThinTarget\_pC\_%s\_stats\_%d"},\textcolor{stringliteral}{"n"},ii);
40       \textcolor{keywordtype}{double} data\_sta = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{univPars}.\hyperlink{class_neutrino_flux_reweight_1_1_parameter_table_acb7dc8335b65b116f6092f2fa57ca5ed}{getParameterValue}(std::string(namepar));       
41       \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3ad5552b4cf05ff2f81a93f3d13432ad}{vbin\_data\_n}.push\_back(data\_sta + data\_sys - data\_cv);
42       
43     \}   
44 
45     
46   \}
\end{DoxyCode}
\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3d6a84d222e16608b80eaaa11f9be224}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\index{$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter}]{\setlength{\rightskip}{0pt plus 5cm}Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::$\sim$\-Thin\-Targetp\-C\-Nucleon\-Reweighter (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3d6a84d222e16608b80eaaa11f9be224}


Definition at line 48 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-cpp.


\begin{DoxyCode}
48                                                                 \{
49     
50   \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a639fe43b3b14e2f1fd277dbbab71cae1}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!calculate\-Data\-Scale@{calculate\-Data\-Scale}}
\index{calculate\-Data\-Scale@{calculate\-Data\-Scale}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{calculate\-Data\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}double Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::calculate\-Data\-Scale (
\begin{DoxyParamCaption}
\item[{int}]{inc\-\_\-pdg, }
\item[{double}]{inc\-\_\-mom, }
\item[{int}]{prod\-\_\-pdg, }
\item[{double}]{xf, }
\item[{double}]{pt}
\end{DoxyParamCaption}
)}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a639fe43b3b14e2f1fd277dbbab71cae1}


Definition at line 119 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-cpp.


\begin{DoxyCode}
119                                                                                                            
                   \{
120  
121     \textcolor{keywordtype}{double} scaling\_violation = 1.0;
122     ThinTargetMC*  dtH =  \hyperlink{class_neutrino_flux_reweight_1_1_thin_target_m_c_a2a114747fed2677cd3b7213555c002b9}{ThinTargetMC::getInstance}();
123     \textcolor{comment}{//temporary:}
124     \textcolor{keyword}{const} \textcolor{keywordtype}{int} Nscl = 11;
125     \textcolor{keyword}{const} \textcolor{keywordtype}{int} moms[Nscl] = \{12,20,31,40,50,60,70,80,100,120,158\};
126     
127     \textcolor{keywordtype}{int} idx\_part = -1;
128     \textcolor{keywordflow}{if}(prod\_pdg == 2212)idx\_part = 4;
129     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(prod\_pdg == 2112)idx\_part = 5;
130     \textcolor{keywordflow}{else}\{
131       std::cout<<\textcolor{stringliteral}{"Error in the prod particle"}<<std::endl;
132       \textcolor{keywordflow}{return} 1.0;
133     \}
134     
135     \textcolor{keywordtype}{int} idx\_lowp = -1;
136     \textcolor{keywordtype}{int} idx\_hip  = -1;
137     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<Nscl-1;i++)\{
138       \textcolor{keywordflow}{if}(inc\_mom>=\textcolor{keywordtype}{double}(moms[i]) && inc\_mom<\textcolor{keywordtype}{double}(moms[i+1]))\{
139         idx\_lowp=i;
140         idx\_hip =i+1;
141       \}
142     \}
143     \textcolor{keywordflow}{if}(idx\_lowp<0 || idx\_hip<0)\{
144       std::cout<<\textcolor{stringliteral}{"Error calculating the scaling"}<<std::endl;
145       \textcolor{keywordflow}{return} 1.0;
146     \}
147 
148     \textcolor{keywordtype}{double} scl\_ref158 = -1.0;
149     \textcolor{keywordtype}{double} scl\_m      =  0.0;
150 
151     \textcolor{keywordflow}{if}(idx\_part==4)\{
152       \textcolor{keywordtype}{int} binid = dtH->hTTScl[idx\_part][Nscl-1]->FindBin(xf,pt);
153       scl\_ref158 = dtH->hTTScl[idx\_part][Nscl-1]->GetBinContent(binid);    
154       \textcolor{comment}{//just provisional... the scaling just reach up to xF=0.8975... consering a close xf value}
155       \textcolor{keywordflow}{if}(xf>0.8975)\{
156         binid = dtH->hTTScl[idx\_part][Nscl-1]->FindBin(0.89,pt);
157         scl\_ref158 = dtH->hTTScl[idx\_part][Nscl-1]->GetBinContent(binid); 
158       \}
159       \textcolor{keywordtype}{double} scl\_low = dtH->hTTScl[idx\_part][idx\_lowp]->GetBinContent(binid);
160       \textcolor{keywordtype}{double} scl\_hi  = dtH->hTTScl[idx\_part][idx\_hip]->GetBinContent(binid);
161       scl\_m   =  scl\_low + (inc\_mom-double(moms[idx\_lowp]))*(scl\_hi-scl\_low)/(double(moms[idx\_hip])-double(
      moms[idx\_lowp]));
162     \}
163     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(idx\_part==5)\{
164       \textcolor{keywordtype}{int} binid = dtH->hTTScl\_n[Nscl-1]->FindBin(xf);
165       scl\_ref158 = (double)dtH->hTTScl\_n[Nscl-1]->GetBinContent(binid); 
166       \textcolor{keywordtype}{double} scl\_low = dtH->hTTScl\_n[idx\_lowp]->GetBinContent(binid);
167       \textcolor{keywordtype}{double} scl\_hi  = dtH->hTTScl\_n[idx\_hip]->GetBinContent(binid);
168       scl\_m   =  scl\_low + (inc\_mom-double(moms[idx\_lowp]))*(scl\_hi-scl\_low)/(double(moms[idx\_hip])-double(
      moms[idx\_lowp]));
169     \}
170     \textcolor{keywordflow}{else}\{
171       std::cout<<\textcolor{stringliteral}{"still error, not expected here!!"}<<std::endl;
172       \textcolor{keywordflow}{return} 1.0;
173     \}
174     
175     \textcolor{keywordflow}{if}(scl\_ref158 < 1.e-10 || scl\_m<1.e-10)\{
176       std::cout<<\textcolor{stringliteral}{"scale problems: "}<<scl\_ref158<<\textcolor{stringliteral}{" "}<<scl\_m<<\textcolor{stringliteral}{" "}<<inc\_pdg<<\textcolor{stringliteral}{" "}<<inc\_mom<<\textcolor{stringliteral}{" "}<<prod\_pdg<<\textcolor{stringliteral}{" "}
      <<xf<<\textcolor{stringliteral}{" "}<<pt<<std::endl;
177       \textcolor{keywordflow}{return} 1.0;
178     \}   
179     scaling\_violation = scl\_m/scl\_ref158;
180     \textcolor{keywordflow}{return} scaling\_violation;
181   \}
\end{DoxyCode}
\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a6bf9833d98dab84af820f05cf2ff851b}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!calculate\-Weight@{calculate\-Weight}}
\index{calculate\-Weight@{calculate\-Weight}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{calculate\-Weight}]{\setlength{\rightskip}{0pt plus 5cm}double Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::calculate\-Weight (
\begin{DoxyParamCaption}
\item[{const {\bf Interaction\-Data} \&}]{inter\-\_\-data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a6bf9833d98dab84af820f05cf2ff851b}


calculate a weight for this interaction given the central value parameters and the parameters for this universe. The weight is something like\-: f(cv)/f(M\-C) $\ast$ f(univ)/f(cv) where cv in this case corresponds to the best value of the parameter, given the data. If univ\-\_\-pars=cv\-\_\-pars then we are calculating a central value weight 



Implements \hyperlink{class_neutrino_flux_reweight_1_1_i_interaction_reweighting_a49b0d73e778411d629205d23575703c3}{Neutrino\-Flux\-Reweight\-::\-I\-Interaction\-Reweighting}.



Definition at line 74 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-cpp.


\begin{DoxyCode}
74                                                                                 \{
75  
76     \textcolor{comment}{//quick check:}
77     \textcolor{keywordtype}{double} wgt = 1.0;
78     ThinTargetBins*  Thinbins =  \hyperlink{class_neutrino_flux_reweight_1_1_thin_target_bins_aeff5cf7220dd08322f5abac2cbc7ff33}{ThinTargetBins::getInstance}();
79     \textcolor{keywordtype}{int} bin\_p = Thinbins->BinID\_pC\_p(aa.xF,aa.Pt,aa.Prod\_pdg);
80     \textcolor{keywordtype}{int} bin\_n = Thinbins->BinID\_pC\_n(aa.xF,aa.Prod\_pdg);
81     \textcolor{keywordflow}{if}(bin\_p < 0 && bin\_n < 0)\{
82       \textcolor{comment}{//std::cout<<"Not bin found "<<std::endl;}
83       \textcolor{keywordflow}{return} wgt;
84     \}
85 
86     \textcolor{comment}{//Calculating the scale:}
87     \textcolor{keywordtype}{double} data\_scale = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a639fe43b3b14e2f1fd277dbbab71cae1}{calculateDataScale}(aa.Inc\_pdg,aa.Inc\_P,aa.Prod\_pdg,aa.xF,aa.Pt);
88     \textcolor{keywordtype}{double} dataval = -1;
89     \textcolor{keywordflow}{if}(aa.Prod\_pdg==2212)dataval = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_affc490a2bc6f148c1eab12f3cba2457d}{vbin\_data\_p}[bin\_p];
90     \textcolor{keywordflow}{if}(aa.Prod\_pdg==2112)dataval = \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3ad5552b4cf05ff2f81a93f3d13432ad}{vbin\_data\_n}[bin\_n];
91     
92     \textcolor{keywordflow}{if}(dataval<1.e-12)\{
93       \textcolor{comment}{//std::cout<<"Not data found "<<std::endl;}
94       \textcolor{keywordflow}{return} wgt;
95     \}
96 
97     \textcolor{comment}{//checking if this is the first interaction:}
98     \textcolor{keywordflow}{if}(aa.gen==0 && aa.Prod\_pdg==2212)dataval /= \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a42193d9c122fad580b96311a7b5e13fb}{data\_prod\_xs};
99     \textcolor{keywordflow}{if}(aa.gen>0  && aa.Prod\_pdg==2212)dataval /= 1.0;
100     \textcolor{keywordflow}{if}(aa.gen==0 && aa.Prod\_pdg==2112)dataval /= 1.0;
101     \textcolor{keywordflow}{if}(aa.gen>0  && aa.Prod\_pdg==2112)dataval *= \hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a42193d9c122fad580b96311a7b5e13fb}{data\_prod\_xs};
102     
103     dataval *= data\_scale;
104  
105     ThinTargetMC*  mc =  \hyperlink{class_neutrino_flux_reweight_1_1_thin_target_m_c_a2a114747fed2677cd3b7213555c002b9}{ThinTargetMC::getInstance}(); 
106     \textcolor{keywordtype}{double} mc\_cv = mc->getMCval\_pC\_X(aa.Inc\_P,aa.xF,aa.Pt,aa.Prod\_pdg); 
107     \textcolor{keywordtype}{double} mc\_prod = mc->getMCxs\_pC\_nucleon(aa.gen,aa.Prod\_pdg,aa.Inc\_P);    
108     mc\_cv /= mc\_prod;
109     \textcolor{keywordflow}{if}(mc\_cv<1.e-12)\textcolor{keywordflow}{return} wgt;
110     wgt = dataval/mc\_cv;
111     \textcolor{keywordflow}{if}(wgt<0)\{
112       std::cout<<\textcolor{stringliteral}{"TTPCNU check wgt(<0) "}<<\hyperlink{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a1c83cab529f6ce4d0f49370289bdf7f9}{iUniv}<<\textcolor{stringliteral}{" "}<<wgt<<\textcolor{stringliteral}{" "}<<aa.Inc\_P<<\textcolor{stringliteral}{" "}<<aa.xF<<\textcolor{stringliteral}{" "}<<aa.Pt<<\textcolor{stringliteral}{" "}<
      <aa.Prod\_pdg<<\textcolor{stringliteral}{" "}<<(mc->getMCxs\_pC\_nucleon(aa.gen,aa.Prod\_pdg,aa.Inc\_P))<<std::endl;
113       \textcolor{keywordflow}{return} 1.0;
114     \}
115 
116     \textcolor{keywordflow}{return} wgt;
117   \}
\end{DoxyCode}
\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a974bafd329ce322beef237061f446694}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!can\-Reweight@{can\-Reweight}}
\index{can\-Reweight@{can\-Reweight}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{can\-Reweight}]{\setlength{\rightskip}{0pt plus 5cm}bool Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::can\-Reweight (
\begin{DoxyParamCaption}
\item[{const {\bf Interaction\-Data} \&}]{aa}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a974bafd329ce322beef237061f446694}


can the particular instance of this class reweight this interaction? 



Implements \hyperlink{class_neutrino_flux_reweight_1_1_i_interaction_reweighting_aa3d1d3f37a93b02e447cf5eca333ac8d}{Neutrino\-Flux\-Reweight\-::\-I\-Interaction\-Reweighting}.



Definition at line 51 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-cpp.


\begin{DoxyCode}
51                                                                           \{
52 
53     \textcolor{comment}{//checking:}
54     std::string mode(getenv(\textcolor{stringliteral}{"MODE"}));
55     \textcolor{keywordflow}{if}(aa.Inc\_pdg != 2212)\textcolor{keywordflow}{return} \textcolor{keyword}{false};
56     \textcolor{keywordflow}{if}(aa.Inc\_P < 12.0)\textcolor{keywordflow}{return} \textcolor{keyword}{false};
57     \textcolor{comment}{//volume check: }
58     \textcolor{keywordtype}{bool} is\_wrong\_volume = aa.Vol != \textcolor{stringliteral}{"TGT1"} && aa.Vol != \textcolor{stringliteral}{"BudalMonitor"} && aa.Vol != \textcolor{stringliteral}{"Budal\_HFVS"} && aa.Vol
       != \textcolor{stringliteral}{"Budal\_VFHS"};
59     \textcolor{keywordflow}{if}( (mode==\textcolor{stringliteral}{"REF"}) || (mode==\textcolor{stringliteral}{"OPT"}) )\{
60       is\_wrong\_volume = aa.Vol != \textcolor{stringliteral}{"TargetFinHorizontal"} && aa.Vol != \textcolor{stringliteral}{"TargetNoSplitSegment"} && aa.Vol!=\textcolor{stringliteral}{"
      tCoreLog"};
61     \}
62     \textcolor{keywordflow}{if}(is\_wrong\_volume)\textcolor{keywordflow}{return} \textcolor{keyword}{false};
63     \textcolor{comment}{//}
64     \textcolor{keywordflow}{if}(aa.Prod\_pdg != 2212 && aa.Prod\_pdg != 2112)\textcolor{keywordflow}{return} \textcolor{keyword}{false};
65     
66     ThinTargetBins*  Thinbins =  \hyperlink{class_neutrino_flux_reweight_1_1_thin_target_bins_aeff5cf7220dd08322f5abac2cbc7ff33}{ThinTargetBins::getInstance}();
67     \textcolor{keywordtype}{int} bin\_p      = Thinbins->BinID\_pC\_p(aa.xF,aa.Pt,aa.Prod\_pdg);
68     \textcolor{keywordtype}{int} bin\_n      = Thinbins->BinID\_pC\_n(aa.xF,aa.Prod\_pdg);
69     \textcolor{keywordflow}{if}(bin\_p < 0 && bin\_n < 0)\textcolor{keywordflow}{return} \textcolor{keyword}{false};
70     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \textcolor{keyword}{true};
71     
72   \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae86a08603fb33286d960ec7c87024f37}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!cv\-Pars@{cv\-Pars}}
\index{cv\-Pars@{cv\-Pars}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{cv\-Pars}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Parameter\-Table}\& Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::cv\-Pars\hspace{0.3cm}{\ttfamily [private]}}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_ae86a08603fb33286d960ec7c87024f37}


Definition at line 29 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a42193d9c122fad580b96311a7b5e13fb}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!data\-\_\-prod\-\_\-xs@{data\-\_\-prod\-\_\-xs}}
\index{data\-\_\-prod\-\_\-xs@{data\-\_\-prod\-\_\-xs}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{data\-\_\-prod\-\_\-xs}]{\setlength{\rightskip}{0pt plus 5cm}double Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::data\-\_\-prod\-\_\-xs}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a42193d9c122fad580b96311a7b5e13fb}


Definition at line 24 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a1c83cab529f6ce4d0f49370289bdf7f9}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!i\-Univ@{i\-Univ}}
\index{i\-Univ@{i\-Univ}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{i\-Univ}]{\setlength{\rightskip}{0pt plus 5cm}int Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::i\-Univ\hspace{0.3cm}{\ttfamily [private]}}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a1c83cab529f6ce4d0f49370289bdf7f9}


Definition at line 28 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!univ\-Pars@{univ\-Pars}}
\index{univ\-Pars@{univ\-Pars}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{univ\-Pars}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Parameter\-Table}\& Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::univ\-Pars\hspace{0.3cm}{\ttfamily [private]}}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a46e36f7b2a8a95bd45bb748408e3bace}


Definition at line 30 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3ad5552b4cf05ff2f81a93f3d13432ad}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!vbin\-\_\-data\-\_\-n@{vbin\-\_\-data\-\_\-n}}
\index{vbin\-\_\-data\-\_\-n@{vbin\-\_\-data\-\_\-n}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{vbin\-\_\-data\-\_\-n}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$float$>$ Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::vbin\-\_\-data\-\_\-n}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_a3ad5552b4cf05ff2f81a93f3d13432ad}


Definition at line 25 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.

\hypertarget{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_affc490a2bc6f148c1eab12f3cba2457d}{\index{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}!vbin\-\_\-data\-\_\-p@{vbin\-\_\-data\-\_\-p}}
\index{vbin\-\_\-data\-\_\-p@{vbin\-\_\-data\-\_\-p}!NeutrinoFluxReweight::ThinTargetpCNucleonReweighter@{Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter}}
\subsubsection[{vbin\-\_\-data\-\_\-p}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$float$>$ Neutrino\-Flux\-Reweight\-::\-Thin\-Targetp\-C\-Nucleon\-Reweighter\-::vbin\-\_\-data\-\_\-p}}\label{class_neutrino_flux_reweight_1_1_thin_targetp_c_nucleon_reweighter_affc490a2bc6f148c1eab12f3cba2457d}


Definition at line 25 of file Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
include/\hyperlink{_thin_targetp_c_nucleon_reweighter_8h}{Thin\-Targetp\-C\-Nucleon\-Reweighter.\-h}\item 
src/\hyperlink{_thin_targetp_c_nucleon_reweighter_8cpp}{Thin\-Targetp\-C\-Nucleon\-Reweighter.\-cpp}\end{DoxyCompactItemize}
